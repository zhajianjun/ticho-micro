<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ticho.upms.infrastructure.mapper.MenuMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="Menu_map" type="com.ticho.upms.infrastructure.entity.Menu">
        <result column="id" property="id"/>
        <result column="parent_id" property="parentId"/>
        <result column="parent_ids" property="parentIds"/>
        <result column="title" property="title"/>
        <result column="type" property="type"/>
        <result column="permission" property="permission"/>
        <result column="res_path" property="resPath"/>
        <result column="http_method" property="httpMethod"/>
        <result column="route_path" property="routePath"/>
        <result column="component_name" property="componentName"/>
        <result column="component_path" property="componentPath"/>
        <result column="res_status" property="resStatus"/>
        <result column="res_sort" property="resSort"/>
        <result column="menu_ext_flag" property="menuExtFlag"/>
        <result column="menu_cache_flag" property="menuCacheFlag"/>
        <result column="menu_hidden_flag" property="menuHiddenFlag"/>
        <result column="menu_icon" property="menuIcon"/>
        <result column="remark" property="remark"/>
        <result column="version" property="version"/>
        <result column="create_by" property="createBy"/>
        <result column="create_time" property="createTime"/>
        <result column="update_by" property="updateBy"/>
        <result column="update_time" property="updateTime"/>
        <result column="is_delete" property="isDelete"/>
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Menu_sql">
        id, parent_id, parent_ids, title, `type`, permission, res_path, http_method, route_path, component_name, component_path, res_status, res_sort, menu_ext_flag, menu_cache_flag, menu_hidden_flag, menu_icon, remark, version, create_by, create_time, update_by, update_time, is_delete
    </sql>


    <insert id="insertBatch" useGeneratedKeys="true" keyProperty="id">
        insert into sys_menu (id, parent_id, parent_ids, title, `type`, permission, res_path, http_method, route_path, component_name, component_path, res_status, res_sort, menu_ext_flag, menu_cache_flag, menu_hidden_flag, menu_icon, remark, version, create_by, create_time, update_by, update_time, is_delete) values
        <foreach collection="ew" item="item" separator=",">
            (#{item.id},#{item.parentId},#{item.parentIds},#{item.title},#{item.type},#{item.permission},#{item.resPath},#{item.httpMethod},#{item.routePath},#{item.componentName},#{item.componentPath},#{item.resStatus},#{item.resSort},#{item.menuExtFlag},#{item.menuCacheFlag},#{item.menuHiddenFlag},#{item.menuIcon},#{item.remark},#{item.version},#{item.createBy},#{item.createTime},#{item.updateBy},#{item.updateTime},#{item.isDelete})
        </foreach>
    </insert>

    <insert id="insertOrUpdate" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO sys_menu
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">id,</if>
            <if test="parentId != null">parent_id,</if>
            <if test="parentIds != null and parentIds != ''">parent_ids,</if>
            <if test="title != null and title != ''">title,</if>
            <if test="type != null and type != ''">`type`,</if>
            <if test="permission != null and permission != ''">permission,</if>
            <if test="resPath != null and resPath != ''">res_path,</if>
            <if test="httpMethod != null and httpMethod != ''">http_method,</if>
            <if test="routePath != null and routePath != ''">route_path,</if>
            <if test="componentName != null and componentName != ''">component_name,</if>
            <if test="componentPath != null and componentPath != ''">component_path,</if>
            <if test="resStatus != null and resStatus != ''">res_status,</if>
            <if test="resSort != null">res_sort,</if>
            <if test="menuExtFlag != null and menuExtFlag != ''">menu_ext_flag,</if>
            <if test="menuCacheFlag != null and menuCacheFlag != ''">menu_cache_flag,</if>
            <if test="menuHiddenFlag != null and menuHiddenFlag != ''">menu_hidden_flag,</if>
            <if test="menuIcon != null and menuIcon != ''">menu_icon,</if>
            <if test="remark != null and remark != ''">remark,</if>
            <if test="version != null">version,</if>
            <if test="createBy != null and createBy != ''">create_by,</if>
            <if test="createTime != null">create_time,</if>
            <if test="updateBy != null and updateBy != ''">update_by,</if>
            <if test="updateTime != null">update_time,</if>
            <if test="isDelete != null">is_delete,</if>
        </trim>
        <trim prefix="values(" suffix=")" suffixOverrides=",">
            <if test="id !=null">#{id},</if>
            <if test="parentId !=null">#{parentId},</if>
            <if test="parentIds !=null and parentIds != ''">#{parentIds},</if>
            <if test="title !=null and title != ''">#{title},</if>
            <if test="type !=null and type != ''">#{type},</if>
            <if test="permission !=null and permission != ''">#{permission},</if>
            <if test="resPath !=null and resPath != ''">#{resPath},</if>
            <if test="httpMethod !=null and httpMethod != ''">#{httpMethod},</if>
            <if test="routePath !=null and routePath != ''">#{routePath},</if>
            <if test="componentName !=null and componentName != ''">#{componentName},</if>
            <if test="componentPath !=null and componentPath != ''">#{componentPath},</if>
            <if test="resStatus !=null and resStatus != ''">#{resStatus},</if>
            <if test="resSort !=null">#{resSort},</if>
            <if test="menuExtFlag !=null and menuExtFlag != ''">#{menuExtFlag},</if>
            <if test="menuCacheFlag !=null and menuCacheFlag != ''">#{menuCacheFlag},</if>
            <if test="menuHiddenFlag !=null and menuHiddenFlag != ''">#{menuHiddenFlag},</if>
            <if test="menuIcon !=null and menuIcon != ''">#{menuIcon},</if>
            <if test="remark !=null and remark != ''">#{remark},</if>
            <if test="version !=null">#{version},</if>
            <if test="createBy !=null and createBy != ''">#{createBy},</if>
            <if test="createTime !=null">#{createTime},</if>
            <if test="updateBy !=null and updateBy != ''">#{updateBy},</if>
            <if test="updateTime !=null">#{updateTime},</if>
            <if test="isDelete !=null">#{isDelete},</if>
        </trim>
        ON DUPLICATE KEY UPDATE
            <if test="id != null">id = values(id),</if>
            <if test="parentId != null">parent_id = values(parent_id),</if>
            <if test="parentIds != null and parentIds != ''">parent_ids = values(parent_ids),</if>
            <if test="title != null and title != ''">title = values(title),</if>
            <if test="type != null and type != ''">`type` = values(`type`),</if>
            <if test="permission != null and permission != ''">permission = values(permission),</if>
            <if test="resPath != null and resPath != ''">res_path = values(res_path),</if>
            <if test="httpMethod != null and httpMethod != ''">http_method = values(http_method),</if>
            <if test="routePath != null and routePath != ''">route_path = values(route_path),</if>
            <if test="componentName != null and componentName != ''">component_name = values(component_name),</if>
            <if test="componentPath != null and componentPath != ''">component_path = values(component_path),</if>
            <if test="resStatus != null and resStatus != ''">res_status = values(res_status),</if>
            <if test="resSort != null">res_sort = values(res_sort),</if>
            <if test="menuExtFlag != null and menuExtFlag != ''">menu_ext_flag = values(menu_ext_flag),</if>
            <if test="menuCacheFlag != null and menuCacheFlag != ''">menu_cache_flag = values(menu_cache_flag),</if>
            <if test="menuHiddenFlag != null and menuHiddenFlag != ''">menu_hidden_flag = values(menu_hidden_flag),</if>
            <if test="menuIcon != null and menuIcon != ''">menu_icon = values(menu_icon),</if>
            <if test="remark != null and remark != ''">remark = values(remark),</if>
            <if test="version != null">version = values(version),</if>
            <if test="createBy != null and createBy != ''">create_by = values(create_by),</if>
            <if test="createTime != null">create_time = values(create_time),</if>
            <if test="updateBy != null and updateBy != ''">update_by = values(update_by),</if>
            <if test="updateTime != null">update_time = values(update_time),</if>
            <if test="isDelete != null">is_delete = values(is_delete)</if>
    </insert>

    <insert id="insertOrUpdateBatch" useGeneratedKeys="true" keyProperty="id">
        insert into sys_menu (id, parent_id, parent_ids, title, `type`, permission, res_path, http_method, route_path, component_name, component_path, res_status, res_sort, menu_ext_flag, menu_cache_flag, menu_hidden_flag, menu_icon, remark, version, create_by, create_time, update_by, update_time, is_delete) values
        <foreach collection="ew" item="item" separator=",">
            (#{item.id},#{item.parentId},#{item.parentIds},#{item.title},#{item.type},#{item.permission},#{item.resPath},#{item.httpMethod},#{item.routePath},#{item.componentName},#{item.componentPath},#{item.resStatus},#{item.resSort},#{item.menuExtFlag},#{item.menuCacheFlag},#{item.menuHiddenFlag},#{item.menuIcon},#{item.remark},#{item.version},#{item.createBy},#{item.createTime},#{item.updateBy},#{item.updateTime},#{item.isDelete})
        </foreach>
        ON DUPLICATE KEY UPDATE
        id = values(id),
        parent_id = values(parent_id),
        parent_ids = values(parent_ids),
        title = values(title),
        `type` = values(`type`),
        permission = values(permission),
        res_path = values(res_path),
        http_method = values(http_method),
        route_path = values(route_path),
        component_name = values(component_name),
        component_path = values(component_path),
        res_status = values(res_status),
        res_sort = values(res_sort),
        menu_ext_flag = values(menu_ext_flag),
        menu_cache_flag = values(menu_cache_flag),
        menu_hidden_flag = values(menu_hidden_flag),
        menu_icon = values(menu_icon),
        remark = values(remark),
        version = values(version),
        create_by = values(create_by),
        create_time = values(create_time),
        update_by = values(update_by),
        update_time = values(update_time),
        is_delete = values(is_delete)
    </insert>

    <select id="selectByConditions" resultMap="Menu_map">
        SELECT
        <include refid="Menu_sql"/>
        FROM sys_menu
        <where>
            <if test="id != null">and id=#{id}</if>
            <if test="parentId != null">and parent_id=#{parentId}</if>
            <if test="parentIds != null">and parent_ids=#{parentIds}</if>
            <if test="title != null">and title=#{title}</if>
            <if test="type != null">and `type`=#{type}</if>
            <if test="permission != null">and permission=#{permission}</if>
            <if test="resPath != null">and res_path=#{resPath}</if>
            <if test="httpMethod != null">and http_method=#{httpMethod}</if>
            <if test="routePath != null">and route_path=#{routePath}</if>
            <if test="componentName != null">and component_name=#{componentName}</if>
            <if test="componentPath != null">and component_path=#{componentPath}</if>
            <if test="resStatus != null">and res_status=#{resStatus}</if>
            <if test="resSort != null">and res_sort=#{resSort}</if>
            <if test="menuExtFlag != null">and menu_ext_flag=#{menuExtFlag}</if>
            <if test="menuCacheFlag != null">and menu_cache_flag=#{menuCacheFlag}</if>
            <if test="menuHiddenFlag != null">and menu_hidden_flag=#{menuHiddenFlag}</if>
            <if test="menuIcon != null">and menu_icon=#{menuIcon}</if>
            <if test="remark != null">and remark=#{remark}</if>
            <if test="version != null">and version=#{version}</if>
            <if test="createBy != null">and create_by=#{createBy}</if>
            <if test="createTime != null">and create_time=#{createTime}</if>
            <if test="updateBy != null">and update_by=#{updateBy}</if>
            <if test="updateTime != null">and update_time=#{updateTime}</if>
            <if test="isDelete != null">and is_delete=#{isDelete}</if>
        </where>
    </select>
</mapper>
